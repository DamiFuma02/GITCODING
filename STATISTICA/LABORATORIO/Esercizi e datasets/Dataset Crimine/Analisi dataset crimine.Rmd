---
title: "Analisi dataset Crimine"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Analisi del dataset Crime
Si analizi il file di dati "Crime_R.csv" che 
contiene un insieme di variabili rilevate per ogni stato degli Stati Uniti, le stesse variabili vengono rilevate a distanza di 10 anni sugli stessi stati (tranne la variabile **Southern**): 


* **CrimeRate**	Tasso di criminalità (numero di reati per milione di abitanti)
* **Youth**	Giovani maschi (numero di maschi di età compresa tra 18 e 24 anni per 1000)
* **Southern**	Stato meridionale 1 = si, 0 = no
* **Education**	Tempo di istruzione (numero medio di anni di scolarizzazione fino a 25)
* **ExpenditureYear0**	Spesa (spesa pro capite per la polizia)
* **LabourForce**	Forza lavoro giovanile (uomini occupati 18-24 per 1000)
* **Males**	Maschi (per 1000 femmine)
* **MoreMales**	Più maschi identificati per 1000 femmine 1 = si, 0 = no
* **StateSize**	Dimensione dello stato (in centinaia di migliaia)
* **YouthUnemployment**	Disoccupazione giovanile (numero di maschi di età compresa tra 18 e 24 anni per 1000) 
* **MatureUnemployment**	Disoccupazione matura (numero di uomini di età compresa tra 35 e 39 anni per 1000)
* **HighYouthUnemploy**	Alto tasso di disoccupazione giovanile 1 = si, 0 = no (alto se i giovani >3*maturi)
* **Wage**	Salario (salario settimanale medio)
* **BelowWage**	Al di sotto del salario (numero di famiglie al di sotto della metà dello stipendio per 1000)

##

```{r}
Crimine <- read.csv("C:/Users/mamel/Desktop/LABORATORIO DI STATISTICA/Network Shortcuts/dataset crimine/Crime_R.csv")
View(Crimine)
dim(Crimine)
summary(Crimine)
names(Crimine)[1]="CrimeRate"
attach(Crimine)
```

## Il tasso di criminalità è distribuito normalmente?
```{r}
summary(CrimeRate)
library(moments)
skewness(CrimeRate)
kurtosis(CrimeRate)

par(mfrow=c(1,3))
hist(CrimeRate,freq=F,xlim=c(0,200),main="Istogramma")
lines(density(CrimeRate),col=2)
curve(dnorm(x,mean(CrimeRate),sd(CrimeRate)),add=T,col=3)
boxplot(CrimeRate,main="Boxplot")
qqnorm(CrimeRate)
qqline(CrimeRate)
```

## La disoccupazione giovanile è distribuita normalmente?
```{r}
summary(YouthUnemployment)
library(moments)
skewness(YouthUnemployment)
kurtosis(YouthUnemployment)

par(mfrow=c(1,3))
hist(YouthUnemployment,freq=F,xlim=c(0,200),main="Istogramma")
lines(density(YouthUnemployment),col=2)
curve(dnorm(x,mean(YouthUnemployment),sd(YouthUnemployment)),add=T,col=3)
boxplot(YouthUnemployment,main='Boxplot')
qqnorm(YouthUnemployment)
qqline(YouthUnemployment)
```

```{r}
b = hist(YouthUnemployment, plot = F)
b$counts
b$breaks
z = (b$breaks-mean(YouthUnemployment))/sd(YouthUnemployment)
b$counts

f_oss = c(12,9,9,8,9)
prob = NULL
z_new = z[-c(6:8)]
n = sum(f_oss)

for(i in 1:(length(z_new)-1)){

prob[i] = pnorm(z_new[i+1])-pnorm(z_new[i])

}

freq_attese = round(prob*n,0)

chi_sq_oss = sum((f_oss-freq_attese)^2/freq_attese)
chi_sq_oss

nu = 5-2-1
qchisq(0.95,nu)
1-pchisq(chi_sq_oss,nu)
```

## Gli stati del sud hanno un tasso di criminalità più alto?

```{r}
boxplot(CrimeRate~Southern)
```


```{r}
tapply(CrimeRate,Southern,length)
tapply(CrimeRate,Southern,mean)
tapply(CrimeRate,Southern,summary)
crime_sud=CrimeRate[Southern==1]
crime_nord=CrimeRate[Southern==0]
```

```{r}
qqnorm(crime_sud)
qqline(crime_sud)
qqnorm(crime_nord)
qqline(crime_nord)
var.test(crime_sud,crime_nord)
t.test(crime_sud,crime_nord,var.equal=T,alternative='greater')
```

## Il tasso di criminalità è aumentato in 10 anni?

```{r}
boxplot(CrimeRate,CrimeRate10,names = c("TC","TC 10 dopo"))
summary(CrimeRate)
summary(CrimeRate10)

diff = CrimeRate-CrimeRate10
boxplot(diff)
qqnorm(diff)
qqline(diff)
t.test(CrimeRate,CrimeRate10,paired=T,alternative='greater')
```

```{r}

b = hist(diff, plot = F)
b$counts
b$breaks
z = (b$breaks-mean(diff))/sd(diff)
b$counts

f_oss = c(7,9,11,5,5,10)
prob = NULL
z_new = z[-c(2,8)]
n = sum(f_oss)

for(i in 1:(length(z_new)-1)){

prob[i] = pnorm(z_new[i+1])-pnorm(z_new[i])

}

freq_attese = round(prob*n,0)

chi_sq_oss = sum((f_oss-freq_attese)^2/freq_attese)
chi_sq_oss

nu = 6-2-1
qchisq(0.95,nu)
1-pchisq(chi_sq_oss,nu)
```

## Esiste una relazione tra l'elevata disoccupazione giovanile e gli stati del sud?

```{r}
tab=table(HighYouthUnemploy,Southern)
tab
chisq.test(tab)
qchisq(0.95,1)
```


## La disoccupazione giovanile è più alta al sud?
```{r}
boxplot(YouthUnemployment~Southern)
tapply(YouthUnemployment,Southern,length)
tapply(YouthUnemployment,Southern,mean)
tapply(YouthUnemployment,Southern,summary)
young_un_sud=YouthUnemployment[Southern==1]
young_un_nord=YouthUnemployment[Southern==0]
```

```{r}
qqnorm(young_un_sud)
qqline(young_un_sud)
```

```{r}
qqnorm(young_un_nord)
qqline(young_un_nord)
```



```{r}
var.test(young_un_sud,young_un_nord)
t.test(young_un_sud,young_un_nord,var.equal=T,alternative='greater')
```

## Relazione tra tasso di criminalità e numero di famiglie sotto la metà del salario

```{r}
hist(BelowWage,prob=T)
boxplot(BelowWage)
cor.test(CrimeRate,BelowWage,method="spearman")
```

## Relazione tra tasso di criminalità e spesa della polizia
```{r}
boxplot(ExpenditureYear0)
cor.test(CrimeRate,ExpenditureYear0,method="spearman")
```

## Il numero di famiglie al di sotto della metà del salario può prevedere il tasso di criminalità?
```{r}
plot(BelowWage,CrimeRate)
mod=lm(CrimeRate~BelowWage)
summary(mod)
abline(mod,col=2)
plot(mod,which=1)
plot(mod,which=2)
plot(mod,which=4)
```



