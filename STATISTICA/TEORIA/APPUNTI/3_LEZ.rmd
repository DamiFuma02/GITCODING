---
title: "LEZIONE_3"
output: pdf_document
date: "`r Sys.Date()`"
---

```{r include=FALSE}
library("dplyr")
```

# [STATISTICA MULTIVARIATA](./2_LEZ.pdf#introduzione)

> PRENDE IN CONSIDERAZIONE 2 O PIÙ VARIABILI CONTEMPORANEAMENTE

## DISTRIBUZIONI DI FREQUENZA

-   **CONGIUNTA**

    -   si prendono in considerazione entrambe le variabili durante una osservazione/misurazione

    -   $(x_{i},y_{k})$

        -   $i \in [1,|X|$

        -   $k \in [1,|Y|]$

-   **DISGIUNTA**

    -   viene presa in considerazione una variabile per volta

-   **CONDIZIONATA**

    -   in base a una condizione dettata da una delle due variabili si cercano le osservazioni congiunte rispetto all'altra variabile

    -   Date X e Y due variabili

        -   Y \| X = valore

        -   seleziona i valori di Y associati ai casi in cui X = valore indicato

```{r}
head(mtcars)
hp6Cyl = mtcars[mtcars$cyl==6,"hp"]
length(hp6Cyl)

```

## RAPPRESENTAZIONI GRAFICHE

> Sono le stesse spiegate nel [capitolo precedente](./2_LEZ.pdf#grafici), in quanto le funzioni grafiche sono in grado di accettare più variabili contemporanemente, ognuna con il suo significato visivo

# DIPENDENZA

> Date due variabili X e Y esse possono essere dipendenti tra loro.

**IPOTESI:**

-   **X variabile indipendente (**per convenzione matematica)

-   **Y variabile dipendente = f(X)**

    -   f è la funzione che regola la dipendenza

    -   può essere di qualsiasi tipo

## TIPOLOGIE

### [DIPENDENZA](#indipendenza)

> **2 QUALITATIVE**

### [DIPENDENZA MEDIA](#dipmed)

> **1 QUALITATIVA 1 QUANTITATIVA**

### [REGRESSIONE](#regr) o [CORRELAZIONE](#correl)

> **2 QUANTITATIVE**

# TABELLA CONTINGENZA

> Riporta le distribuzioni di frequenza associate alle due variabili, perciò gli assi contengono gli elementi del supporto delle variabili, cioè i possibili valori ammessi senza ripetizioni

![](images/paste-E0F09CDF.png){width="202"}

-   $X = [x_{1},...,x_{i},...,x_{m}], i \in [1,m], m = |Sx|$

-   $Y = [y_{1},...,y_{i},...,y_{k}], i \in [1,k], k = |Sy|$

$$
n = \sum_{i=1}^{m} n_{i+} =  \sum_{j=1}^{k} n_{+j}
$$

## FREQUENZA

-   **CONGIUNTA:**

    -   $n_{ij}=(x_{i},y_{j})$

-   **MARGINALE:**

    -   si tratta delle occorrenze dell'i-esimo valore di una delle variabili

        -   $n_{i+}=x_{i} = \sum_{j=1}^{k}n_{ij}$ --\> i=riga costante

        -   $n_{+j}=y_{j} = \sum_{i=1}^{m}n_{ij}$ --\> j=colonna costante

-   **CONDIZIONATA**

    -   $n_{i1}$ = vettore delle frequenze di X dato Y = y1

## ESEMPIO

```{r}
attitudine <- rbind(cbind(rep("S",1),rep("S",1)),cbind(rep("S",3),rep("B",3)),cbind(rep("B",1),rep("S",1)),cbind(rep("B",3),rep("B",3)),cbind(rep("B",2),rep("O",2)),cbind(rep("O",2),rep("S",2)),cbind(rep("O",1),rep("B",1)),cbind(rep("O",2),rep("O",2)))
                                                                                                                                                                                                           attitudine <- as.data.frame(attitudine) # matrice trasformata
# in data frame
colnames(attitudine) <- c("X","Y") # nomi delle colonne
attitudine$X <- ordered(attitudine$X, levels=c("S","B","O"))
attitudine$Y <- ordered(attitudine$Y, levels=c("S","B","O"))
str(attitudine)

tab <- table(attitudine$X,attitudine$Y) # tabella di contingenza
#(distribuzione di frequenza assoluta congiunta)
tab

# distribuzione marginale di Y
# (frequenza assoluta)
margin.table(tab,2)

# distribuzione condizionata di Y|X=S (frequenza assoluta)
tab[1,]

# distribuzione condizionata di Y|X=B (frequenza assoluta)
tab[2,]

tab[3,] # distribuzione condizionata di Y|X=O (frequenza assoluta)

tab[,1] # distribuzione condizionata di X|Y=S (frequenza assoluta)

tab/sum(tab) # distribuzione di frequenza relativa congiunta
# in alternativa, prop.table(tab)
# distribuzione marginale di X (frequenza relativa)
margin.table(tab,1)/sum(margin.table(tab,1))

# distribuzione marginale di Y (frequenza relativa)
margin.table(tab,2)/sum(margin.table(tab,2))

# distribuzione condizionata di Y|X=S (frequenza relativa)
tab[1,]/sum(tab[1,])

# distribuzione condizionata di Y|X=B (frequenza relativa)
tab[2,]/sum(tab[2,])
```

# INDIPENDENZA STATISTICA {#indipendenza}

> Viene misurata in maniera SIMMETRICA, perchè X e Y possono influenzarsi a vicenda, dipende dal punto di vista

$$
\frac{n_{rc}}{n_{+c}} =  \frac{n_{r+}}{n}
$$

> -   $r \in [1;m]$
>
> -   $c \in [1;k]$

$$
n_{rc} = \frac{n_{r+}*n_{+c}}{n}
$$

> questo valore corrisonde al valore ideale che la frequenza dovrebbe avere in caso di completa INDIPENDENZA tra le due variabili X e Y considerate

## INDICE DI CONNESSIONE

> Determina la forza della dipendenza che c'è tra le due variabili considerate

$$
\chi^2 = \sum_{r=1}^{m} \sum_{c=1}^{k} \frac{(n_{rs} - n^{*}_{rs})^2}{n^{*}_{rs}}
$$

$$
n^{*}_{rs} = \frac{n_{r+}*n_{+c}}{n}
$$

> $n^{*}_{rs}$ **= valore nel caso di completa indipendenza tra X e Y**

### INDIPENDENZA

$$
\chi^2 = 0 = (n_{rs} - n^{*}_{rs})^2 = (n_{rs} - n^{*}_{rs}), \forall r \in [1;m], \forall s \in [1;k] 
$$

> I valori attesi coincidono con quelli osservati, quindi vi è completa indipendenza

### DIPENDENZA

$$
\chi^2 \in ]0;min(m-1,k-1)]
$$

# DIPENDENZA MEDIA {#dipmed}

> Si misura in maniera ASIMMETRICA

-   X = QUALITATIVA INDIPENDENTE

-   Y = QUANTITATIVA DIPENDENTE = in funzione di X

> Non viene misurata la distribuzione di frequenza della variabile Y, ma solo la sua MEDIA

$$
E(Y | X = x_{i}) 
$$

> Media dei valori di Y associati al valore $x_{i}$

## INDIPENDENZA IN MEDIA

$$
E(Y) = E(Y | X = x_{i}) = E(Y | X = x_{k}), \forall i \neq k
$$

# CORRELAZIONE {#correl}

# REGRESSIONE {#regr}
